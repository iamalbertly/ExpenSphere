<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://apis.google.com https://accounts.google.com https://sheets.googleapis.com https://*.googleapis.com https://raw.githubusercontent.com; connect-src 'self' http://127.0.0.1:* http://localhost:* https://sheets.googleapis.com https://accounts.google.com https://apis.googleapis.com https://*.googleapis.com https://raw.githubusercontent.com https://*.githubusercontent.com; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self'; frame-src https://accounts.google.com"><title>Expense Tracker v0.0.15</title><style>body{ font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #1e1e2e; color: #f5f5f5; margin: 0; padding: 0; min-height: 100vh; display: flex; flex-direction: column;} .container{ margin: 20px auto; width: 90%; max-width: 600px; background-color: #28293d; padding: 20px; border-radius: 10px; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3); flex: 1;} h1{ text-align: center; margin-bottom: 20px; margin-top: 0; color: #f5a623;} textarea{ width: 100%; height: 120px; background-color: #33344b; color: #f5f5f5; border: none; padding: 5px; border-radius: 8px; font-size: 16px; resize: none;} textarea:focus{ outline: none; border: 2px solid #f5a623;} button{ width: 100%; padding: 15px; background-color: #f5a623; color: #1e1e2f; border: none; border-radius: 8px; font-size: 16px; cursor: pointer; margin-top: 10px;} button:hover{ background-color: #d48821;} .editable-container{ display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin: 15px 0;} .editable-field{ display: flex; flex-direction: column; margin-bottom: 0;} .editable-field.full-width{ grid-column: 1 / -1;} .editable-label{ font-size: 14px; margin-bottom: 5px; color: #8e8ea0;} .editable-input, .editable-select{ padding: 8px 12px; border-radius: 8px; border: none; background-color: #33344b; color: #f5f5f5; font-size: 14px; height: 36px;} .editable-input[type="text"]{ height: 36px;} .confidence-score{ grid-column: 1 / -1; text-align: right; color: #8e8ea0; font-size: 14px; margin-top: 10px;} .loading-overlay{ display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.7); z-index: 1000; justify-content: center; align-items: center;} .loading-spinner{ width: 50px; height: 50px; border: 5px solid #f5f5f5; border-top: 5px solid #f5a623; border-radius: 50%; animation: spin 1s linear infinite;} @keyframes spin{ 0%{ transform: rotate(0deg);} 100%{ transform: rotate(360deg);} } .error-notification{ display: none; position: fixed; top: 0; left: 0; right: 0; background-color: #ff4444; color: white; padding: 15px; z-index: 1001; animation: slideDown 0.5s ease-out;} .error-notification.show{ display: flex; justify-content: space-between; align-items: flex-start;} .error-content{ flex-grow: 1; margin-right: 20px;} .error-title{ font-weight: bold; margin-bottom: 5px;} .error-message{ font-size: 14px;} .error-close{ background: none; border: none; color: white; font-size: 20px; cursor: pointer; padding: 0 5px;} @keyframes slideDown{ from{ transform: translateY(-100%);} to{ transform: translateY(0);} } .version{ font-size: 14px; color: #f5a623; margin-left: 10px; opacity: 0.8;} @media screen and (max-width: 768px){ body{ background-color: #28293d;} .container{ margin: 0; width: 90%; max-width: 90%; min-height: 100vh; border-radius: 0; box-shadow: none; padding: 15px;} .input-section{ padding: 15px;} .input-section textarea{ height: 60px;} .results-section{ padding: 0;} .editable-container{ grid-template-columns: 1fr;}} .success-notification{ display: none; position: fixed; top: 20px; right: 20px; background-color: #4CAF50; color: white; padding: 15px; border-radius: 4px; z-index: 1001; animation: slideIn 0.5s ease-out;} .success-notification.show{ display: block;} @keyframes slideIn{ from{ transform: translateX(100%);} to{ transform: translateX(0);}} .results-section{ background-color: #1e1e2e; border-radius: 8px; padding: 15px; margin-top: 20px; box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.2);} .input-section{ background-color: #33344b; border-radius: 8px; padding: 15px; margin-bottom: 20px;} .editable-container{ display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin: 15px 0; background-color: #33344b; padding: 15px; border-radius: 8px;} .editable-field{ background-color: #28293d; padding: 10px; border-radius: 6px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);} .editable-label{ font-size: 12px; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 8px; color: #f5a623;} .editable-input, .editable-select{ width: 100%; padding: 8px 12px; border-radius: 6px; border: 1px solid #444; background-color: #1e1e2e; color: #f5f5f5; font-size: 14px; transition: border-color 0.3s ease;} .editable-input:focus, .editable-select:focus{ border-color: #f5a623; outline: none;} .confidence-score{ grid-column: 1 / -1; text-align: center; background-color: #28293d; padding: 10px; border-radius: 6px; margin-top: 15px; font-weight: bold; color: #f5a623;} @media screen and (max-width: 768px){ .container{ margin: 0; width: 100%; max-width: 100%; min-height: 100vh; border-radius: 0; box-shadow: none; padding: 15px;} .editable-container{ grid-template-columns: 1fr; gap: 10px; padding: 10px;} .input-section{ padding: 10px;} .input-section textarea{ height: 80px;} .editable-field{ margin-bottom: 5px;} .confidence-score{ margin-top: 10px; font-size: 14px;}} .success-notification{ background-color: #4CAF50; color: white; padding: 15px 20px; border-radius: 8px; position: fixed; top: 20px; right: 20px; z-index: 1000; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); transform: translateX(120%); transition: transform 0.3s ease-out;} .success-notification.show{ transform: translateX(0);} @media screen and (max-width: 768px){ body{ padding-bottom: 60px; } .container{ margin: 0; width: 100%; max-width: 100%; min-height: auto; border-radius: 0; box-shadow: none; padding: 10px; display: flex; flex-direction: column;} .results-section{ order: 1; margin-top: 0; margin-bottom: 10px; max-height: 60vh; overflow-y: auto; padding: 10px;} .input-section{ order: 2; position: sticky; bottom: 0; background-color: #28293d; padding: 10px; margin: 0; box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.2);} .input-section textarea{ height: 60px; font-size: 16px; padding: 8px;} .input-section button{ margin-top: 5px; padding: 10px;} .editable-container{ grid-template-columns: 1fr; gap: 8px; padding: 8px;} .editable-field{ margin-bottom: 4px; padding: 8px;} .editable-input, .editable-select{ font-size: 16px; padding: 6px 10px; height: 36px;} .confidence-score{ margin-top: 8px; padding: 8px;} .results-section{ scroll-behavior: smooth;} .editable-input:active, .editable-select:active, .editable-input:focus, .editable-select:focus{ transform: scale(0.99);} .editable-label{ padding: 4px 0;} select.editable-select{ padding-right: 24px; }} </style></head><body><div class="loading-overlay"><div class="loading-spinner"></div></div><div class="error-notification"><div class="error-content"><div class="error-title">Error Occurred</div><div class="error-message"></div></div><button class="error-close" onclick="closeError()">Ã—</button></div><div class="container"><h1>Expense Tracker <span class="version">v0.0.15</span></h1><div class="results-section"><div class="editable-container" id="editableContainer"></div></div><div class="input-section"><textarea id="inputText" placeholder="Type your expense description and press Enter..."></textarea><button onclick="authorize()">Submit</button></div></div><script>// Environment and configuration management const ENV={ isDev: window.location.hostname==='localhost' || window.location.hostname==='127.0.0.1', isGitHub: window.location.hostname.includes('github.io'), isProd: window.location.hostname==='serengetipremiersolutions.com', port: 3000, get apiBaseUrl(){ if (this.isDev){ const port=window.location.port || this.port; return `http://${window.location.hostname}:${port}/api/`;} return 'https://sheets.googleapis.com/v4/';}}; // Configuration management const CONFIG={ clientId: null, githubUser: 'serengetipremiersolutions', githubRepo: 'ExpenSphere', githubBranch: 'main', // Get config paths based on environment get configPaths(){ if (ENV.isDev){ return ['./config.json', './config.js'];} if (ENV.isGitHub){ return ['./config.json'];} // Production paths return ['./config.json'];}, async init(){ try{ // Try localStorage first for returning users const storedConfig=localStorage.getItem('expenseTrackerConfig'); if (storedConfig){ const parsedConfig=JSON.parse(storedConfig); if (parsedConfig.clientId){ this.clientId=parsedConfig.clientId; return;}} // Try GitHub raw content if not in development if (!ENV.isDev){ try{ const githubUrl=this.getGithubRawUrl('config.json'); const response=await fetch(githubUrl); if (response.ok){ const config=await response.json(); if (config?.clientId){ this.clientId=config.clientId; localStorage.setItem('expenseTrackerConfig', JSON.stringify({ clientId: config.clientId})); return;}}} catch (e){ console.debug('No GitHub config found');}} // Try local paths as fallback for (const path of this.configPaths){ try{ const response=await fetch(path); if (response.ok){ let config; if (path.endsWith('.js')){ const text=await response.text(); const configContent=text.replace('export default', ''); config=Function(`return ${configContent}`)();} else{ config=await response.json();} if (config?.clientId){ this.clientId=config.clientId; localStorage.setItem('expenseTrackerConfig', JSON.stringify({ clientId: config.clientId})); return;}}} catch (e){ console.debug(`No config found at ${path}`);}} // If no configuration is found, prompt user const userClientId=prompt( 'Please enter your Google OAuth Client ID. You can get this from your Google Cloud Console.', '' ); if (userClientId){ this.clientId=userClientId; localStorage.setItem('expenseTrackerConfig', JSON.stringify({ clientId: userClientId}));} else{ throw new Error('Client ID is required to use this application.');}} catch (error){ showError( 'Configuration Error', 'Failed to load application configuration.', error.message ); throw error;}}, getGithubRawUrl(filepath){ return `https://raw.githubusercontent.com/${this.githubUser}/${this.githubRepo}/${this.githubBranch}/${filepath}`;}}; // Constants const FETCH_TIMEOUT=30000; const SCOPES="https://www.googleapis.com/auth/spreadsheets"; const SPREADSHEET_ID="__SPREADSHEET_ID__"; const VERSION={ major: 0, minor: 0, patch: 15, toString(){ return `${this.major}.${this.minor}.${this.patch}`;}}; // Initialize the application async function initializeApp(){ try{ await CONFIG.init(); setupEventListeners(); const inputTextArea=document.getElementById('inputText'); if (inputTextArea){ inputTextArea.focus();}} catch (error){ console.error('Failed to initialize app:', error); showError( 'Initialization Error', 'Failed to initialize the application.', error.message );}} // Safe initialization wrapper (function(){ if (document.readyState==='loading'){ document.addEventListener('DOMContentLoaded', initializeApp);} else{ initializeApp();}})(); // Update authorize function to use CONFIG.clientId async function authorize(){ if (!CONFIG.clientId){ showError( 'Configuration Error', 'Client ID is not configured.', 'Please ensure the application is properly configured with a Google OAuth Client ID.' ); return;} tokenClient=google.accounts.oauth2.initTokenClient({ client_id: CONFIG.clientId, scope: SCOPES, callback: async (response)=>{ if (response.error){ showError('Authentication Error', 'Failed to authenticate with Google.', response.error); return;} try{ TOKEN_MANAGEMENT.storeToken(response.access_token); // Process the current input after successful authentication processInput();} catch (error){ showError('Processing Error', 'Failed to process input after authentication.', error.message);}}}); tokenClient.requestAccessToken();} // Event constants const EVENTS={ INPUT: 'input', KEYDOWN: 'keydown', LOAD: 'load', DOMCONTENTLOADED: 'DOMContentLoaded'}; // Initialize global variables let generatedData=null; let tokenClient=null; // Token management functions const TOKEN_MANAGEMENT={ isTokenValid(token){ if (!token) return false; return fetchWithTimeout( `${ENV.apiBaseUrl}spreadsheets/${SPREADSHEET_ID}/values/ExpenseResults!A1`, { headers:{ Authorization: `Bearer ${token}`,},} ) .then(response=>response.ok) .catch(()=>false);}, storeToken(token){ try{ localStorage.setItem('expenseTrackerToken', token); localStorage.setItem('tokenTimestamp', new Date().getTime());} catch (e){ console.error('Error storing token:', e);}}, getStoredToken(){ try{ const token=localStorage.getItem('expenseTrackerToken'); const timestamp=localStorage.getItem('tokenTimestamp'); if (token && timestamp){ const now=new Date().getTime(); const hourInMs=60 * 60 * 1000; if (now - parseInt(timestamp) < hourInMs){ return token;}} return null;} catch (e){ console.error('Error getting stored token:', e); return null;}}, clearStoredToken(){ try{ localStorage.removeItem('expenseTrackerToken'); localStorage.removeItem('tokenTimestamp');} catch (e){ console.error('Error clearing token:', e);}}}; // Add fetch configuration const fetchConfig={ mode: 'cors', credentials: 'same-origin', headers:{ 'Content-Type': 'application/json'}}; // Core functionality function setupEventListeners(){ const inputTextArea=document.getElementById('inputText'); let debounceTimeout; inputTextArea.addEventListener('input', function(){ clearTimeout(debounceTimeout); debounceTimeout=setTimeout(processInput, 300);}); inputTextArea.addEventListener(EVENTS.KEYDOWN, function(event){ if (event.key==='Enter' && !event.shiftKey){ event.preventDefault(); clearTimeout(debounceTimeout); processInput();}}); inputTextArea.addEventListener('paste', function(){ setTimeout(processInput, 0);}); // Modified: Only refocus textarea when clicking empty container space document.querySelector('.container').addEventListener('click', function(event){ const isFormElement=event.target.closest('input, select, button, .editable-field'); if (!isFormElement){ inputTextArea.focus();}});} // Training data and analysis functions const trainingData=[ { category: "Petrol & Transport", keywords: ["petrol", "raum", "bmw", "fuel", "gas", "diesel", "transport", "fare", "taxi", "uber", "bolt", "baught petrol", "put petrol", "filled", "mafuta", "put fuel", "transport to", "nauli"]}, { category: "Car Maintenance & Fee's", keywords: ["repair", "maintenance", "oil", "service", "garage", "mechanic", "spare", "parts", "car wash", "insurance", "fundi", "fixed", "tire", "puncture", "parking", "brakes", "coil"]}, { category: "Gift to Family & Friends", keywords: ["gave", "gift", "send", "irene", "family", "friend", "support", "help", "sent to", "mchango", "changia", "asked for", "faith", "tina", "benadeta", "wine", "bear", "konyag"]}, { category: "Groceries", keywords: ["grocery", "shopping", "supermarket", "market", "food", "household", "milk", "water", "uhai", "mkaa", "rice", "mchele", "maziwa", "breakfast", "eggs", "sugar", "mboga", "gulio", "dogfood", "sabuni", "maid", "house", "domestic", "worker"]}, { category: "Eating Out", keywords: ["food", "restaurant", "lunch", "dinner", "eat", "meal", "snack", "cafe", "bought food", "food at", "food while", "food from", "pizza", "kfc", "chips mayai", "mishkaki", "fast food", "mtori", "breakfast"]}, { category: "Utilities", keywords: ["luku", "electricity", "water bill", "internet", "wifi", "gas", "trash", "takataka", "security", "netflix", "gass", "dawasa", "bill", "payment", "utility", "baught luku", "put luku", "added luku"]}, { category: "Aaliyah School Fee", keywords: ["school", "fee", "aaliyah", "education", "tuition", "uniform", "books", "graduation", "karate"]} ]; // Add utility-specific patterns const UTILITY_PATTERNS={ luku: ["luku", "electricity", "power"], water: ["water bill", "dawasa", "water payment"], internet: ["wifi", "internet", "netflix"], security: ["security", "ulinzi", "guard"], gas: ["gas", "gass", "gas cylinder"]}; // First pass: Check exact phrases const exactPhrases={ "Eating Out": ["bought food", "food at", "food while", "food from", "pizza hut", "kfc", "chips mayai"], "Groceries": ["gave to maid", "left money home", "gave money to maid", "for home", "nyumbani"], "Gift to Family & Friends": ["gave to irene", "sent to irene", "gave irene", "irene asked"], "Utilities": ["baught luku", "paid luku", "added luku", "put luku", "paid bill", "water bill", "security payment"]}; // Context weights const CONTEXT_WEIGHTS={ PRIMARY_ACTION: 0.35, RECIPIENT: 0.30, PURPOSE: 0.25, AMOUNT: 0.10}; // Update fetch handling async function fetchWithTimeout(url, options={}){ const controller=new AbortController(); const timeoutId=setTimeout(()=>controller.abort(), FETCH_TIMEOUT); try{ const response=await fetch(url,{ ...fetchConfig, ...options, signal: controller.signal}); clearTimeout(timeoutId); return response;} catch (error){ clearTimeout(timeoutId); if (error.name==='AbortError'){ throw new Error('Request timed out');} console.error('Fetch error:', error); throw error;}} // Add the analyzeTextContext function function analyzeTextContext(text){ const lowerText=text.toLowerCase(); let bestCategory=null; let highestConfidence=0; let evidence=[]; // First pass: Check utility-specific patterns for (const [utilityType, patterns] of Object.entries(UTILITY_PATTERNS)){ if (patterns.some(pattern=>lowerText.includes(pattern))){ bestCategory="Utilities"; highestConfidence=0.95; evidence.push(`Utility match: ${utilityType}`); break;}} // Second pass: Check exact phrases if no utility match if (!bestCategory){ for (const [category, phrases] of Object.entries(exactPhrases)){ for (const phrase of phrases){ if (lowerText.includes(phrase)){ bestCategory=category; highestConfidence=0.95; evidence.push(`Exact phrase match: "${phrase}"`); break;}} if (bestCategory) break;}} // Third pass: Check categories with context if (!bestCategory){ trainingData.forEach(category=>{ let confidence=0; let categoryEvidence=[]; // Check keywords with word boundary const keywordMatches=category.keywords.filter(keyword=>{ const pattern=new RegExp(`\\b${keyword}\\b`, 'i'); return pattern.test(lowerText);}); if (keywordMatches.length >0){ const keywordScore=keywordMatches.length / category.keywords.length; confidence +=keywordScore * CONTEXT_WEIGHTS.PRIMARY_ACTION; categoryEvidence.push(`Matched keywords: ${keywordMatches.join(", ")}`);} // Context-specific boosts if (category.category==="Utilities" && (lowerText.includes("bill") || lowerText.includes("payment") || lowerText.includes("paid") || lowerText.includes("baught"))){ confidence +=0.3; categoryEvidence.push("Payment context boost");} if (confidence >highestConfidence){ highestConfidence=confidence; bestCategory=category.category; evidence=categoryEvidence;}});} // Normalize confidence to percentage const confidencePercentage=Math.min(Math.round(highestConfidence * 100), 100); return{ category: bestCategory || "(OTHER) Food, Transport, Groceries, etc.", confidence: confidencePercentage, amount: extractAmount(text), evidence: evidence};} // Add helper functions function extractAmount(text){ const patterns=[ /(\d+)k/i, /(\d+)[,\s]?000/, /(\d+)\s*thousand/i, /(\d+)/ ]; for (let pattern of patterns){ const match=text.match(pattern); if (match){ let amount=parseInt(match[1]); if (pattern.toString().includes('k') || pattern.toString().includes('thousand')){ amount *=1000;} return amount;}} return 0;} // Add UI helper functions function showLoading(){ document.querySelector('.loading-overlay').style.display='flex';} function hideLoading(){ document.querySelector('.loading-overlay').style.display='none';} function showError(title, message, details){ const notification=document.querySelector('.error-notification'); notification.querySelector('.error-title').textContent=title; notification.querySelector('.error-message').innerHTML=` <p>${message}</p>${details ? `<p><strong>Details:</strong>${details}</p>` : ''} ${message.includes('Authentication') ? '<p><strong>Solution:</strong>Please try submitting again to re-authenticate.</p>' : ''} ${message.includes('permission') ? '<p><strong>Solution:</strong>Please ensure you have edit access to the spreadsheet.</p>' : ''} `; notification.classList.add('show');} function closeError(){ document.querySelector('.error-notification').classList.remove('show');} function showSuccess(message){ const notification=document.createElement('div'); notification.className='success-notification show'; notification.textContent=message; document.body.appendChild(notification); setTimeout(()=>notification.remove(), 3000);} // Add the missing processInput function function processInput(){ const inputText=document.getElementById("inputText").value; if (inputText.trim()===""){ document.getElementById("editableContainer").innerHTML=""; window.generatedData=null; return;} const analysis=analyzeTextContext(inputText); // Determine paid to based on category and context let paidTo=determinePaidTo(inputText, analysis.category); window.generatedData={ "Date of Transaction": new Date().toISOString().split("T")[0], "Where did the money come from?": "ALBERT", "How much money? (Tsh)": analysis.amount.toString(), "What's the Purchase Category": analysis.category, "Purchase Description": inputText, "Where was the money payed to?": paidTo, "Confidance level": `${analysis.confidence}%`}; displayEditableFields(window.generatedData); // Log evidence for debugging console.debug("Analysis Evidence:", analysis.evidence);} // Add the missing determinePaidTo function function determinePaidTo(text, category){ text=text.toLowerCase(); // Direct recipient matches if (text.includes('irene')){ return "Gave to Irene";} else if (text.includes('maid') || text.includes('nyumbani') || text.includes('essau')){ return "Gave to Maid (nyumbani)";} else if (text.includes('bmw')){ return "Spent on BMW";} else if (text.includes('raum')){ return "Spent on Raum";} else if (text.includes('guta')){ return "Spent on Guta";} else if (text.includes('luku')){ return "Luku";} else if (text.includes('tina') || text.includes('tinah')){ return "Gave to Parents - Tina";} else if (text.includes('alrada')){ return "ALRADA - Expenses";} else if (text.includes('benadeta') || text.includes('benadetha')){ return "Gave to Benadeta";} // Category-based defaults const categoryDefaults={ "Gift to Family & Friends": "Gave to Irene", "Petrol & Transport": "Spent on Raum", "Car Maintenance & Fee's": "Spent on Raum", "Groceries": "Gave to Maid (nyumbani)", "Eating Out": "(OTHER) Food, Transport, Groceries, etc.", "Utilities": "(OTHER) Food, Transport, Groceries, etc.", "Aaliyah School Fee": "Aaliyah School Fee"}; return categoryDefaults[category] || "(OTHER) Food, Transport, Groceries, etc.";} // Add the missing displayEditableFields function function displayEditableFields(data){ const container=document.getElementById("editableContainer"); container.innerHTML=``; const dateField=document.createElement("div"); dateField.className="editable-field"; dateField.innerHTML=` <label class="editable-label">Date</label><input type="date" class="editable-input" value="${data["Date of Transaction"]}" onchange="updateField('Date of Transaction', this.value)">`; container.appendChild(dateField); const amountField=document.createElement("div"); amountField.className="editable-field"; amountField.innerHTML=` <label class="editable-label">Amount (Tsh)</label><input type="number" class="editable-input" value="${data["How much money? (Tsh)"]}" onchange="updateField('How much money? (Tsh)', this.value)">`; container.appendChild(amountField); const categoryField=document.createElement("div"); categoryField.className="editable-field"; const categoryOptions=trainingData .map(cat=>`<option value="${cat.category}" ${cat.category===data["What's the Purchase Category"] ? "selected" : ""}>${cat.category}</option>`) .join(""); categoryField.innerHTML=` <label class="editable-label">Category</label><select class="editable-select" onchange="updateField('What\'s the Purchase Category', this.value)">${categoryOptions} <option value="(OTHER) Food, Transport, Groceries, etc.">(OTHER) Food, Transport, Groceries, etc.</option></select>`; container.appendChild(categoryField); const paidToField=document.createElement("div"); paidToField.className="editable-field"; const paidToOptions=[ "Spent on BMW", "Spent on Raum", "Gave to Maid (nyumbani)", "Gave to Irene", "Aaliyah School Fee", "ALRADA - Expenses", "Gave to Parents - Tina", "Spent on Guta", "Luku", "(OTHER) Food, Transport, Groceries, etc." ].map(option=>`<option value="${option}" ${option===data["Where was the money payed to?"] ? "selected" : ""}>${option}</option>`).join(""); paidToField.innerHTML=` <label class="editable-label">Paid To</label><select class="editable-select" onchange="updateField('Where was the money payed to?', this.value)">${paidToOptions} </select>`; container.appendChild(paidToField); const descriptionField=document.createElement("div"); descriptionField.className="editable-field full-width"; descriptionField.innerHTML=` <label class="editable-label">Description</label><input type="text" class="editable-input" value="${data["Purchase Description"]}" onchange="updateField('Purchase Description', this.value)">`; container.appendChild(descriptionField); const confidenceField=document.createElement("div"); confidenceField.className="confidence-score"; confidenceField.innerHTML=`Confidence Score: ${data["Confidance level"]}`; container.appendChild(confidenceField);} </script><script src="https://apis.google.com/js/api.js" defer></script><script src="https://accounts.google.com/gsi/client" defer></script></body></html>